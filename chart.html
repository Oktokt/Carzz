<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الرسم البياني للمبيعات</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart', 'line']});

        // تحميل الرسم البياني للمبيعات اليومية
        function drawChart(salesData) {
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'التاريخ');
            data.addColumn('number', 'السعر');

            salesData.forEach(sale => {
                data.addRow([sale.date, parseFloat(sale.price)]);
            });

            var options = {
                title: 'مبيعات اليوم',
                curveType: 'function',
                legend: { position: 'bottom' }
            };

            var chart = new google.visualization.LineChart(document.getElementById('salesChart'));
            chart.draw(data, options);
        }

        // جلب المبيعات من جوجل شيت
        async function fetchSalesData() {
            try {								
                const response = await fetch("https://script.google.com/macros/s/AKfycbx8xb73O131kaeifzcvVF87W_Kx1QzjgnnTlk-ZNZn_U719ze7VI19tauhTK_os1X8O/exec?action=getSales");
                const data = await response.json();
                drawChart(data.sales);
            } catch (error) {
                console.error("خطأ في جلب المبيعات:", error);
            }
        }

        google.charts.setOnLoadCallback(fetchSalesData);
    </script>
</head>
<body>

    <h1>الرسم البياني للمبيعات</h1>

    <div id="salesChart" style="width: 100%; height: 500px;"></div>

</body>
</html>
